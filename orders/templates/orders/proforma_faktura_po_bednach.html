<!DOCTYPE html>
{% load static %}
{% load custom_filters %}
{% load i18n %}
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Proforma faktura</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @media print {
            @page {
                size: A4 landscape;
                margin: 10mm;
            }
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
        body {
            font-size: 0.9rem;
            font-family: 'Liberation Sans', 'Arial';
        }
        .table td, .table th {
            padding: 0rem !important;
            vertical-align: middle;
        }

        /* PDF velikosti textu */
        .fs-80 { font-size: 8rem; }
        .fs-50 { font-size: 5rem; }
        .fs-35 { font-size: 3.5rem; }
        .fs-30 { font-size: 3rem; }
        .fs-25 { font-size: 2.5rem; }
        .fs-20 { font-size: 2rem; }
        .fs-17 { font-size: 1.75rem; }
        .fs-15 { font-size: 1.5rem; }
        .fs-12 { font-size: 1.25rem; }
        .fs-11 { font-size: 1.125rem; }
        .fs-10 { font-size: 1rem; }
        .fs-09 { font-size: 0.9rem; }
        .fs-08 { font-size: 0.8rem; }
        .fs-07 { font-size: 0.7rem; }
        .fs-06 { font-size: 0.6rem; }
    </style>
</head>
<body>
    <table class="table" style="width: 100%; table-layout: fixed; margin-bottom: 1mm; margin-top: 0;">
        <tbody>
            <tr>
                <td class="text-start fs-10" style="width: 25%;">
                    HPM HEAT SK, s.r.o.<br>
                    Naftárska 1413<br>
                    908 45 Gbely<br>
                </td>
                <td class="text-center fs-15 fw-bold" style="width: 50%;">
                    HPM HEAT SK<br>
                    <div class="fs-10 fw-normal">
                        Proforma faktúra ({{ kamion.zakaznik.nazev }})
                    </div>
                    <div class="fs-10">
                        {{ kamion.cislo_dl|nahrada_pomlcky_za_lomitko }}
                    </div>
                </td>
                <td class="text-end fs-10" style="width: 25%;">
                    Gbely dňa: {{ kamion.datum|date:"d. m. Y" }}<br>
                </td>                
            </tr>
        </tbody>
    </table>
    <table class="table table-striped text-center
        {% if kamion.zakaznik.fakturovat_rovnani and kamion.zakaznik.fakturovat_tryskani %}fs-07
        {% elif kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}fs-08
        {% else %}fs-09
        {% endif %}"
        style="width: 100%; table-layout: fixed;">
        <tbody>
            {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}
                <tr>
                    <th colspan="5"></th>
                    <th colspan="3" class="text-center" style="border-left: 1px solid black; border-right: 1px solid black;">
                        Kalení
                    </th>
                    {% if kamion.zakaznik.fakturovat_rovnani %}
                        <th colspan="3" class="text-center" style="border-right: 1px solid black; background-color: #f0f0f0;">
                            Rovnání
                        </th>
                    {% endif %}
                    {% if kamion.zakaznik.fakturovat_tryskani %}
                        <th colspan="3" class="text-center" style="border-right: 1px solid black; background-color: #e0e0e0;">
                            Tryskání
                        </th>
                    {% endif %}
                </tr>
            {% endif %}
            <tr>
                <th>Poz.<br>Pos.</th>
                <th>Obj. č.<br>Order no.</th>
                <th>Typ<br>Item no.</th>
                <th>Popis<br>Description</th>                
                <th>Rozměr<br>Dimension</th>                
                <th {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %} style="border-left: 1px solid black;"{% endif %}>Hmotnost<br>Weight</th>
                <th>Cena<br>Price</th>
                <th {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %} style="border-right: 1px solid black;"{% endif %}>Celkem<br>Price total</th>                                            
                {% if kamion.zakaznik.fakturovat_rovnani %}
                    <th style="background-color: #f0f0f0;">Hmotnost<br>Weight</th>
                    <th style="background-color: #f0f0f0;">Cena<br>Price</th>
                    <th style="border-right: 1px solid black; background-color: #f0f0f0;">Celkem<br>Price total</th>
                {% endif %}
                {% if kamion.zakaznik.fakturovat_tryskani %}
                    <th style="background-color: #e0e0e0;">Hmotnost<br>Weight</th>
                    <th style="background-color: #e0e0e0;">Cena<br>Price</th>
                    <th style="border-right: 1px solid black; background-color: #e0e0e0;">Celkem<br>Price total</th>
                {% endif %}
            </tr>
            {% flatten_bedny kamion.zakazky_vydej.all as bedny_list %}
            {% for pos, bedna, zakazka in bedny_list %}
                {% if bedna.fakturovat %}
                    <tr class="text-center">
                        <td>{{ pos }}</td>
                        <td>{{ bedna.vyrobni_zakazka|default:"" }}</td>
                        <td>{{ zakazka.artikl }}</td>
                        <td style="white-space: nowrap;">{{ zakazka.zkraceny_popis|truncatechars:20 }}</td>               
                        <td>{{ zakazka.prumer }}x{{ zakazka.delka|floatformat:0 }}</td>                         
                        <td {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}style="border-left: 1px solid black;"{% endif %}>{{ bedna.hmotnost|floatformat:1|default:"0,0" }} kg</td>
                        <td>{{ bedna.cena_za_kg|floatformat:2 }} €</td>
                        <td {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}style="border-right: 1px solid black;"{% endif %}>{{ bedna.cena_za_bednu|floatformat:2 }} €</td>
                        {% if kamion.zakaznik.fakturovat_rovnani %}
                            {% if bedna.rovnat == 'VY' %}
                                <td style="background-color: #f0f0f0;">{{ bedna.hmotnost|floatformat:1|default:"0,0" }} kg</td>
                            {% else %}
                                <td style="background-color: #f0f0f0;">0,0 kg</td>
                            {% endif %}
                            <td style="background-color: #f0f0f0;">{{ bedna.cena_rovnani_za_kg|floatformat:2 }} €</td>
                            <td style="border-right: 1px solid black; background-color: #f0f0f0;">{{ bedna.cena_rovnani_za_bednu|floatformat:2 }} €</td>
                        {% endif %}
                        {% if kamion.zakaznik.fakturovat_tryskani %}
                            {% if bedna.tryskat == 'OT' %}
                                <td style="background-color: #e0e0e0;">{{ bedna.hmotnost|floatformat:1|default:"0,0" }} kg</td>
                            {% else %}
                                <td style="background-color: #e0e0e0;">0,0 kg</td>
                            {% endif %}
                            <td style="background-color: #e0e0e0;">{{ bedna.cena_tryskani_za_kg|floatformat:2 }} €</td>
                            <td style="border-right: 1px solid black; background-color: #e0e0e0;">{{ bedna.cena_tryskani_za_bednu|floatformat:2 }} €</td>
                        {% endif %}
                    </tr>
                {% endif %}
            {% endfor %}
            <tr class="text-center fw-bold">
                <td colspan="5"></td>
                <td {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}style="border-left: 1px solid black;"{% endif %}>{{ kamion.celkova_hmotnost_fakturovanych_netto|floatformat:"1g" }} kg</td>                
                <td></td>
                <td {% if kamion.zakaznik.fakturovat_rovnani or kamion.zakaznik.fakturovat_tryskani %}style="border-right: 1px solid black;"{% endif %}>{{ kamion.cena_za_kamion_vydej|floatformat:"2g" }} €</td>
                {% if kamion.zakaznik.fakturovat_rovnani %}
                    <td style="background-color: #f0f0f0;">{{ kamion.hmotnost_vyrovnanych_beden|floatformat:"1g"|default:"0,0" }} kg</td>
                    <td style="background-color: #f0f0f0;"></td>
                    <td style="border-right: 1px solid black; background-color: #f0f0f0;">{{ kamion.cena_rovnani_za_kamion_vydej|floatformat:"2g"|default:"0,00" }} €</td>
                {% endif %}
                {% if kamion.zakaznik.fakturovat_tryskani %}
                    <td style="background-color: #e0e0e0;">{{ kamion.hmotnost_otryskanych_beden|floatformat:"1g"|default:"0,0" }} kg</td>
                    <td style="background-color: #e0e0e0;"></td>
                    <td style="border-right: 1px solid black; background-color: #e0e0e0;">{{ kamion.cena_tryskani_za_kamion_vydej|floatformat:"2g"|default:"0,00" }} €</td>
                {% endif %}
            </tr>
        </tbody>
    </table>    
</body>
</html>